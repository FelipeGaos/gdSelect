class GDSelect{constructor(e,t={}){this.select="string"==typeof e?document.querySelector(e):e,this.config=Object.assign({search:!0,placeholder:"Seleccione...",multiple:this.select.hasAttribute("multiple"),multipleSelectedText:"opciones seleccionadas"},t),this.multiple=this.config.multiple,this.selectedValues=new Set,this.build(),this.bindEvents(),this.observeClassChanges()}build(){this.select.style.display="none";const e=document.createElement("div");e.classList.add("gdselect-wrapper"),this.select.className&&(this.select.className.split(" ").forEach(t=>{t&&!e.classList.contains(t)&&e.classList.add(t)})),e.tabIndex=0;const t=document.createElement("div");t.classList.add("gdselect-header"),t.textContent=this.config.placeholder,e.appendChild(t);const n=document.createElement("div");n.classList.add("gdselect-dropdown"),this.config.search&&((this.searchInput=document.createElement("input")).type="text",this.searchInput.classList.add("gdselect-search"),this.searchInput.placeholder="",n.appendChild(this.searchInput)),Array.from(this.select.options).forEach(e=>{const t=document.createElement("div");t.classList.add("gdselect-option"),t.dataset.value=e.value,t.textContent=e.textContent,e.disabled&&t.classList.add("disabled"),e.selected&&(t.classList.add("selected"),this.selectedValues.add(e.value)),n.appendChild(t)}),e.appendChild(n),this.select.parentNode.insertBefore(e,this.select.nextSibling),this.updateHeader()}observeClassChanges(){this.observer=new MutationObserver(e=>{e.forEach(e=>{"attributes"===e.type&&"class"===e.attributeName&&(this.select.className.split(" ").forEach(t=>{t&&!this.wrapper.classList.contains(t)&&this.wrapper.classList.add(t)}),Array.from(this.wrapper.classList).forEach(e=>{"gdselect-wrapper"!==e&&!this.select.className.split(" ").includes(e)&&this.wrapper.classList.remove(e)}))})}),this.observer.observe(this.select,{attributes:!0,attributeFilter:["class"]})}bindEvents(){this.wrapper.addEventListener("click",e=>{e.target.classList.contains("gdselect-option")&&!e.target.classList.contains("disabled")?this.toggleOption(e.target):(this.dropdown.classList.toggle("open"),this.config.search&&this.dropdown.classList.contains("open")?(this.searchInput.style.display="block",this.searchInput.focus()):this.config.search&&(this.searchInput.style.display="none",this.searchInput.value="",this.filterOptions("")))}),this.config.search&&this.searchInput.addEventListener("input",()=>{this.filterOptions(this.searchInput.value.toLowerCase())}),document.addEventListener("click",e=>{this.wrapper.contains(e.target)||(this.dropdown.classList.remove("open"),this.config.search&&(this.searchInput.style.display="none",this.searchInput.value="",this.filterOptions("")))}),this.wrapper=this.select.nextElementSibling,this.header=this.wrapper.querySelector(".gdselect-header"),this.dropdown=this.wrapper.querySelector(".gdselect-dropdown"),this.config.search&&(this.searchInput=this.dropdown.querySelector(".gdselect-search"))}filterOptions(e){this.dropdown.querySelectorAll(".gdselect-option").forEach(t=>{const n=t.textContent.toLowerCase();t.style.display=n.includes(e)?"block":"none"})}toggleOption(e){const t=e.dataset.value;if(this.multiple)this.selectedValues.has(t)?(this.selectedValues.delete(t),e.classList.remove("selected")):(this.selectedValues.add(t),e.classList.add("selected"));else{this.selectedValues.clear(),this.selectedValues.add(t),this.dropdown.querySelectorAll(".gdselect-option").forEach(e=>e.classList.remove("selected")),e.classList.add("selected"),this.dropdown.classList.remove("open")}this.updateHeader(),this.syncSelect()}updateHeader(){0===this.selectedValues.size?this.header.textContent=this.config.placeholder:this.multiple?this.header.textContent=`${this.selectedValues.size} ${this.config.multipleSelectedText}`:(this.selectedVal=[...this.selectedValues][0],this.selectedOption=Array.from(this.select.options).find(e=>e.value===this.selectedVal),this.header.textContent=this.selectedOption?this.selectedOption.textContent:this.config.placeholder)}syncSelect(){Array.from(this.select.options).forEach(e=>{e.selected=this.selectedValues.has(e.value)});const e=new Event("change",{bubbles:!0});this.select.dispatchEvent(e)}setValue(e){Array.isArray(e)||(e=[e]),this.selectedValues=new Set(e.map(String)),this.dropdown.querySelectorAll(".gdselect-option").forEach(t=>{t.classList.toggle("selected",this.selectedValues.has(t.dataset.value))}),this.updateHeader(),this.syncSelect()}getValue(){return this.multiple?[...this.selectedValues]:[...this.selectedValues][0]||null}} 